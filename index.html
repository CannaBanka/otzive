<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Отзывы с Firebase</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 30px auto; padding: 0 20px; }
    h1, h2 { text-align: center; }
    form input, form textarea { width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; font-size: 1rem; }
    form button { padding: 10px 15px; font-size: 1rem; cursor: pointer; }
    .review { border: 1px solid #ddd; padding: 10px; margin: 10px 0; }
    .review strong { font-size: 1.1rem; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>
  <h1>Оставьте отзыв</h1>
  <form id="reviewForm">
    <input type="text" id="name" placeholder="Ваше имя" required />
    <textarea id="message" placeholder="Ваш отзыв" required></textarea>
    <button type="submit">Отправить</button>
  </form>

  <h2>Одобренные отзывы</h2>
  <div id="approvedReviews"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDUs_53Iek1mKi2GcJCduz2N-d_3kWHW3o",
      authDomain: "tets-c92b3.firebaseapp.com",
      databaseURL: "https://tets-c92b3-default-rtdb.firebaseio.com",
      projectId: "tets-c92b3",
      storageBucket: "tets-c92b3.appspot.com",
      messagingSenderId: "989700479323",
      appId: "1:989700479323:web:80387b013848a140c2a27e"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const reviewForm = document.getElementById('reviewForm');
    const approvedReviewsDiv = document.getElementById('approvedReviews');

    reviewForm.addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const message = document.getElementById('message').value.trim();
      if (!name || !message) {
        alert('Пожалуйста, заполните все поля.');
        return;
      }

      const newReviewRef = db.ref('reviews').push();
      newReviewRef.set({
        name,
        message,
        approved: false,
        timestamp: Date.now()
      });

      alert('Спасибо за отзыв! Он будет опубликован после модерации.');
      reviewForm.reset();
    });

    function showApprovedReviews() {
      db.ref('reviews').orderByChild('approved').equalTo(true).on('value', snapshot => {
        approvedReviewsDiv.innerHTML = '';
        snapshot.forEach(childSnapshot => {
          const review = childSnapshot.val();
          const div = document.createElement('div');
          div.className = 'review';
          div.innerHTML = `<strong>${review.name}</strong><p>${review.message}</p>`;
          approvedReviewsDiv.appendChild(div);
        });
      });
    }

    showApprovedReviews();
  </script>
</body>
</html>
